HTTP response
*************

.[perex]
Nette zapouzdřuje HTTP odpověď do objektů se srozumitelným API.

Instalace:

```shell
composer require nette/http
```

Zda je ještě možné odesílat hlavičky či měnit stavový kód, prozradí metoda `isSent()`. Pokud vrací TRUE, nepůjde již žádnou další hlavičku či kód odeslat.

V takovém případě každý pokus o odeslání vyvolá výjimku `Nette\InvalidStateException`.

Stavový [kód odpovědi |https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10] odešleme nebo získáme takto:

```php
$httpResponse->setCode(Nette\Http\Response::S404_NOT_FOUND);

echo $httpResponse->getCode(); // 404
```

Kvůli lepší srozumitelnosti zdrojového kódu doporučujeme pro kód používat místo čísla [předdefinované konstanty |https://api.nette.org/2.3/Nette.Http.IResponse.html#S100_CONTINUE].

Metoda `setContentType($type, $charset=NULL)` mění hlavičku `Content-Type`:

```php
$httpResponse->setContentType('text/plain', 'UTF-8');
```

Přesměrování na jiné URL provede metoda `redirect($url, $code=302)`. Nezapomeňte poté ukončit skript!

```php
$httpResponse->redirect('http://example.com');
exit;
```


Pro nastavení expirace (vypršení platnosti) dokumentu použijeme metodu `setExpiration()`. Jejím parametrem je buď textový údaj, počet vteřin, nebo timestamp:

```php
// cache prohlížeče vyprší za hodinu
$httpResponse->setExpiration('+ 1 hours');
```

HTTP hlavičku odešleme:

```php
$httpResponse->setHeader('Pragma', 'no-cache');

// nebo chceme-li stejnou hlavičku odeslat vícekrát s různými hodnotami
$httpResponse->addHeader('Pragma', 'no-cache');
```

Odeslané HTTP hlavičky zjistíme přes:

```php
// vrací asociativní pole HTTP hlaviček
$headers = $httpResponse->getHeaders();

// vrací konkrétní hlavičku (case-insensitive)
$pragma = $httpResponse->getHeader('Pragma');
```

Pro manipulaci s cookies slouží metody `setCookie()` a `deleteCookie()`:

```php
// setCookie($name, $value, $time, [$path, [$domain, [$secure, [$httpOnly])
$httpResponse->setCookie('lang', 'cs', '100 days'); // odešle cookie

// deleteCookie($name, [$path, [$domain, [$secure]]])
$httpResponse->deleteCookie('lang'); // smaže cookie
```

Tyto dvě metody přijímají ještě další parametry: `$path` (podadresář kde bude cookie dostupná), `$domain` a `$secure`. Jejich podrobný popis najdete u PHP funkce [php:setcookie].

{{composer: nette/http}}
